<!doctype html>
<html lang='ru'>
<head>
  <meta charset='utf-8' />
  <meta name='viewport' content='width=device-width, initial-scale=1' />
  <title>–†–æ–ª—å</title>
  <style>
    body { font-family: system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif; margin: 20px; line-height: 1.4; }
    .card { border: 1px solid #e2e8f0; border-radius: 12px; padding: 16px; max-width: 900px; }
    dt { font-weight: 600; }
    dd { margin: 0 0 8px 0; }
    .actions { margin: 12px 0; }
    a.btn, button { background: #2563eb; color: white; border: 0; padding: 10px 14px; border-radius: 8px; cursor: pointer; text-decoration:none; }
    a.btn.secondary { background: #334155; }
    table { width:100%; border-collapse: collapse; }
    th, td { border-bottom:1px solid #e2e8f0; padding:6px; text-align:left; }
  </style>
  </head>
<body>
  <h2>–†–æ–ª—å #{{ role.id }} ‚Äî {{ role.name }}</h2>
  <div class='actions'>
    <a class='btn secondary' href='/topic/{{ role.topic_id }}'>–ù–∞–∑–∞–¥ –∫ —Ç–µ–º–µ</a>
  </div>
  <div class='card'>
    <dl>
      <dt>–¢–µ–º–∞</dt><dd>{{ role.topic_title }}</dd>
      <dt>–ê–≤—Ç–æ—Ä</dt><dd>{{ role.author }}</dd>
      <dt>–û–ø–∏—Å–∞–Ω–∏–µ —Ä–æ–ª–∏</dt><dd>{{ role.description or '-' }}</dd>
      <dt>–¢—Ä–µ–±—É–µ–º—ã–µ –Ω–∞–≤—ã–∫–∏</dt><dd>{{ role.required_skills or '-' }}</dd>
      <dt>–í–º–µ—Å—Ç–∏–º–æ—Å—Ç—å</dt><dd>{{ role.capacity or '-' }}</dd>
      <dt>–£—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω—ã–π —Å—Ç—É–¥–µ–Ω—Ç</dt>
      <dd>
        {% if role.approved_student_user_id %}
          <a href='/user/{{ role.approved_student_user_id }}'>#{{ role.approved_student_user_id }}</a>
          <form method='post' action='/api/roles/{{ role.id }}/clear-approved' style='display:inline;'>
            <input type='hidden' name='by_user_id' value='{{ role.author_user_id }}' />
            <button type='submit'>–°–Ω—è—Ç—å —É—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ</button>
          </form>
        {% else %}-{% endif %}
      </dd>
    </dl>
  </div>

  <div class='card' style='margin-top:12px;'>
    <h3>–ö–∞–Ω–¥–∏–¥–∞—Ç—ã (—Ç–æ–ø-10)</h3>
    {% if candidates %}
      <table>
        <tr><th>–ú–µ—Å—Ç–æ</th><th>–°—Ç—É–¥–µ–Ω—Ç</th><th>Username</th><th>–û—Ü–µ–Ω–∫–∞</th></tr>
        {% for c in candidates %}
          <tr>
            <td>{{ c.rank or '-' }}</td>
            <td><a href='/user/{{ c.user_id }}'>{{ c.full_name }}</a></td>
            <td>{{ c.username or '-' }}</td>
            <td>{{ '%.2f'|format(c.score) if c.score is not none else '-' }}</td>
          </tr>
        {% endfor %}
      </table>
    {% else %}
      <p>–ü–æ–∫–∞ –Ω–µ—Ç –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤.</p>
    {% endif %}
    <form method='post' action='/do-match-role' style='margin-top:12px;'>
      <input type='hidden' name='role_id' value='{{ role.id }}' />
      <button type='submit'>üß† –ü–æ–¥–æ–±—Ä–∞—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</button>
    </form>
  </div>
</body>
</html>
